<!--
$PostgreSQL: pgsql/doc/src/sgml/ref/create_opclass.sgml,v 1.13 2005/01/14 01:16:52 tgl Exp $
PostgreSQL documentation
-->

<refentry id="SQL-CREATEOPCLASS">
 <refmeta>
  <refentrytitle id="sql-createopclass-title">CREATE OPERATOR CLASS</refentrytitle>
  <refmiscinfo>SQL - Comandos da Linguagem</refmiscinfo>
 </refmeta>

 <refnamediv>
  <refname>CREATE OPERATOR CLASS</refname>
  <refpurpose>cria uma classe de operadores</refpurpose>
 </refnamediv>

 <indexterm zone="sql-createopclass">
  <primary>CREATE OPERATOR CLASS</primary>
 </indexterm>

 <refsynopsisdiv>
<synopsis>
CREATE OPERATOR CLASS <replaceable class="parameter">nome</replaceable> [ DEFAULT ] FOR TYPE <replaceable class="parameter">tipo_de_dado</replaceable> USING <replaceable class="parameter">método_de_índice</replaceable> AS
  {  OPERATOR <replaceable class="parameter">número_da_estratégia</replaceable> <replaceable class="parameter">nome_do_operador</replaceable> [ ( <replaceable class="parameter">tipo_do_operador</replaceable>, <replaceable class="parameter">tipo_do_operador</replaceable> ) ] [ RECHECK ]
   | FUNCTION <replaceable class="parameter">número_de_suporte</replaceable> <replaceable class="parameter">nome_da_função</replaceable> ( <replaceable class="parameter">tipo_do_argumento</replaceable> [, ...] )
   | STORAGE <replaceable class="parameter">tipo_armazenado</replaceable>
  } [, ... ]
</synopsis>
 </refsynopsisdiv>

 <refsect1>
  <title>Descrição</title>

  <para>
   O comando <command>CREATE OPERATOR CLASS</command> cria uma classe de
   operadores. Uma classe de operadores define como um determinado tipo de dado
   pode ser usado em um índice. A classe de operadores especifica que certos
   operadores vão preencher determinados papéis, ou <quote>estratégias</quote>,
   para este tipo de dado e este método de índice. A classe de operadores também
   especifica os procedimentos de suporte a serem usados pelo método do índice
   quando a classe de operadores é selecionada para uma coluna do índice. Todos
   os operadores e funções usados por uma classe de operadores devem ser
   definidos antes da classe de operadores ser criada.
  </para>

  <para>
   Se o nome do esquema for fornecido, então a classe de operadores é criada no
   esquema especificado, senão é criada no esquema corrente.
   Duas classes de operadores no mesmo esquema podem ter o mesmo nome
   somente se forem para métodos de índice diferentes.
  </para>

  <para>
   O usuário que cria a classe de operadores se torna seu dono. Atualmente
   o usuário criador deve ser um superusuário; esta restrição é feita
   porque uma definição de classe de operadores errada pode confundir, ou
   mesmo derrubar, o servidor.
  </para>

  <para>
   Atualmente o comando <command>CREATE OPERATOR CLASS</command> não verifica se
   a definição da classe de operadores inclui todos os operadores e funções
   requeridos pelo método de índice. É responsabilidade do usuário
   definir uma classe de operadores válida.
  </para>

  <para>
   Consulte a <xref linkend="xindex"> para obter informações adicionais.
  </para>
 </refsect1>

 <refsect1>
  <title>Parâmetros</title>

  <variablelist>
   <varlistentry>
    <term><replaceable class="parameter">nome</replaceable></term>
    <listitem>
     <para>
      O nome da classe de operadores a ser criada.
      O nome pode ser qualificado pelo esquema.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><literal>DEFAULT</literal></term>
    <listitem>
     <para>
      Se estiver presente, a classe de operadores se tornará a classe de
      operadores padrão para seu tipo de dado. No máximo uma classe de
      operadores pode ser a classe padrão para um determinado tipo de dado e
      método de índice.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">tipo_de_dado</replaceable></term>
    <listitem>
     <para>
      O tipo de dado de coluna que esta classe de operadores se destina.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">método_de_índice</replaceable></term>
    <listitem>
     <para>
      O nome do método de índice que esta classe de operadores se destina.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">número_da_estratégia</replaceable></term>
    <listitem>
     <para>
      O número da estratégia do método de índice para um operador
      associado com a classe de operadores.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">nome_do_operador</replaceable></term>
    <listitem>
     <para>
      O nome (opcionalmente qualificado pelo esquema) de um operador associado
      com a classe de operadores.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">tipo_do_operador</replaceable></term>
    <listitem>
     <para>
      Os tipos de dado dos operandos de um operador, ou
      <literal>NONE</literal> indicando um operador unário-esquerdo ou
      unário-direito. Os tipos de dado dos operandos podem ser omitidos no caso
      usual, onde são iguais ao tipo de dado da classe de operadores.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><literal>RECHECK</literal></term>
    <listitem>
     <para>
      Se estiver presente, o índice para este operador é <quote>lossy</quote>
      (com perdas) e, portanto, as linhas trazidas usando o índice devem ser
      verificadas outra vez para ver se realmente satisfazem a cláusula de
      qualificação envolvendo este operador.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">número_de_suporte</replaceable></term>
    <listitem>
     <para>
      O número do procedimento de suporte do método de índice
      para a função associada com a classe de operadores.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">nome_da_função</replaceable></term>
    <listitem>
     <para>
      O nome (opcionalmente qualificado pelo esquema) da função que é
      o procedimento de suporte do método de índice para a classe de operadores.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">tipos_dos_argumentos</replaceable></term>
    <listitem>
     <para>
      Os tipos de dado dos parâmetros da função.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term><replaceable class="parameter">tipo_armazenado</replaceable></term>
    <listitem>
     <para>
      O tipo de dado realmente armazenado no índice. Geralmente é o mesmo
      tipo de dado da coluna, mas alguns métodos de índice (somente
      <literal>GIST</literal> no momento) permitem que seja diferente.
      A cláusula <literal>STORAGE</literal> deve ser omitida, a menos que o
      método de índice permita o uso de um tipo diferente.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>

  <para>
   As cláusulas <literal>OPERATOR</literal>, <literal>FUNCTION</literal> e
   <literal>STORAGE</literal> podem ser escritas em qualquer ordem.
  </para>
 </refsect1>

 <refsect1>
  <title>Observações</title>

  <para>
   Os operadores não devem ser definidos por funções SQL. É possível que a
   função SQL seja incorporada (<literal>inlined</literal>)
   ao comando que faz a chamada, não permitindo que o otimizador reconheça que
   o comando corresponde a um índice.
  </para>
 </refsect1>

 <refsect1>
  <title>Exemplos</title>

  <para>
   O exemplo mostrado abaixo define uma classe de operadores de índice GiST
   para o tipo de dado <literal>_int4</literal> (matriz de <type>int4</type>).
   Consulte <filename>contrib/intarray/</filename> para ver o exemplo completo.
  </para>

<programlisting>
CREATE OPERATOR CLASS gist__int_ops
    DEFAULT FOR TYPE _int4 USING gist AS
        OPERATOR        3       &&,
        OPERATOR        6       =       RECHECK,
        OPERATOR        7       @,
        OPERATOR        8       ~,
        OPERATOR        20      @@ (_int4, query_int),
        FUNCTION        1       g_int_consistent (internal, _int4, int4),
        FUNCTION        2       g_int_union (bytea, internal),
        FUNCTION        3       g_int_compress (internal),
        FUNCTION        4       g_int_decompress (internal),
        FUNCTION        5       g_int_penalty (internal, internal, internal),
        FUNCTION        6       g_int_picksplit (internal, internal),
        FUNCTION        7       g_int_same (_int4, _int4, internal);
</programlisting>
 </refsect1>

 <refsect1>
  <title>Compatibilidade</title>

  <para>
    O comando <command>CREATE OPERATOR CLASS</command>
    é uma extensão do <productname>PostgreSQL</productname>.
    Não existe o comando <command>CREATE OPERATOR CLASS</command>
    no padrão SQL.
  </para>
 </refsect1>

 <refsect1>
  <title>Consulte também</title>

  <simplelist type="inline">
   <member><xref linkend="sql-alteropclass" endterm="sql-alteropclass-title"></member>
   <member><xref linkend="sql-dropopclass" endterm="sql-dropopclass-title"></member>
  </simplelist>
 </refsect1>
</refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:nil
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../reference.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:"/usr/lib/sgml/catalog"
sgml-local-ecat-files:nil
End:
-->
