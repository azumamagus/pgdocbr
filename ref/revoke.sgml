<!--
$PostgreSQL: pgsql/doc/src/sgml/ref/revoke.sgml,v 1.32 2004/11/05 19:15:52 tgl Exp $
PostgreSQL documentation
-->

<refentry id="SQL-REVOKE">
 <refmeta>
  <refentrytitle id="sql-revoke-title">REVOKE</refentrytitle>
  <refmiscinfo>SQL - Comandos da Linguagem</refmiscinfo>
 </refmeta>

 <refnamediv>
  <refname>REVOKE</refname>
  <refpurpose>revoga privilégios de acesso</refpurpose>
 </refnamediv>

 <indexterm zone="sql-revoke">
  <primary>REVOKE</primary>
 </indexterm>

 <refsynopsisdiv>
<synopsis>
REVOKE [ GRANT OPTION FOR ]
    { { SELECT | INSERT | UPDATE | DELETE | RULE | REFERENCES | TRIGGER }
    [,...] | ALL [ PRIVILEGES ] }
    ON [ TABLE ] <replaceable class="parameter">nome_da_tabela</replaceable> [, ...]
    FROM { <replaceable class="parameter">nome_do_usuário</replaceable> | GROUP <replaceable class="parameter">nome_do_grupo</replaceable> | PUBLIC } [, ...]
    [ CASCADE | RESTRICT ]

REVOKE [ GRANT OPTION FOR ]
    { { CREATE | TEMPORARY | TEMP } [,...] | ALL [ PRIVILEGES ] }
    ON DATABASE <replaceable>nome_do_banco_de_dados</replaceable> [, ...]
    FROM { <replaceable class="parameter">nome_do_usuário</replaceable> | GROUP <replaceable class="parameter">nome_do_grupo</replaceable> | PUBLIC } [, ...]
    [ CASCADE | RESTRICT ]

REVOKE [ GRANT OPTION FOR ]
    { EXECUTE | ALL [ PRIVILEGES ] }
    ON FUNCTION <replaceable>nome_da_função</replaceable> ([<replaceable>tipo</replaceable>, ...]) [, ...]
    FROM { <replaceable class="parameter">nome_do_usuário</replaceable> | GROUP <replaceable class="parameter">nome_do_grupo</replaceable> | PUBLIC } [, ...]
    [ CASCADE | RESTRICT ]

REVOKE [ GRANT OPTION FOR ]
    { USAGE | ALL [ PRIVILEGES ] }
    ON LANGUAGE <replaceable>nome_da_linguagem</replaceable> [, ...]
    FROM { <replaceable class="parameter">nome_do_usuário</replaceable> | GROUP <replaceable class="parameter">nome_do_grupo</replaceable> | PUBLIC } [, ...]
    [ CASCADE | RESTRICT ]

REVOKE [ GRANT OPTION FOR ]
    { { CREATE | USAGE } [,...] | ALL [ PRIVILEGES ] }
    ON SCHEMA <replaceable>nome_do_esquema</replaceable> [, ...]
    FROM { <replaceable class="parameter">nome_do_usuário</replaceable> | GROUP <replaceable class="parameter">nome_do_grupo</replaceable> | PUBLIC } [, ...]
    [ CASCADE | RESTRICT ]

REVOKE [ GRANT OPTION FOR ]
    { CREATE | ALL [ PRIVILEGES ] }
    ON TABLESPACE <replaceable>nome_do_espaço_de_tabelas</replaceable> [, ...]
    FROM { <replaceable class="parameter">nome_do_usuário</replaceable> | GROUP <replaceable class="parameter">nome_do_grupo</replaceable> | PUBLIC } [, ...]
    [ CASCADE | RESTRICT ]
</synopsis>
 </refsynopsisdiv>

 <refsect1 id="SQL-REVOKE-description">
  <title>Descrição</title>

  <para>
   O comando <command>REVOKE</command> revoga, de um ou mais usuários ou
   grupos de usuários, privilégios concedidos anteriormente. A palavra chave
   <literal>PUBLIC</literal> se refere ao grupo contendo todos os usuários,
   definido implicitamente.
  </para>

  <para>
   Veja na descrição do comando
   <xref linkend="sql-grant" endterm="sql-grant-title">
   o significado de cada de privilégio.
  </para>

  <para>
   Deve ser observado que um determinado usuário possui a soma dos privilégios
   concedidos diretamente para o próprio usuário mais os privilégios concedidos
   para os grupos dos quais é membro no momento, mais os privilégios concedidos
   para <literal>PUBLIC</literal>.
   Daí, por exemplo, revogar o privilégio <literal>SELECT</literal>
   de <literal>PUBLIC</literal> não significa, necessariamente, que todos os
   usuários perdem o privilégio <literal>SELECT</literal> para o objeto:
   àqueles que receberam o privilégio diretamente, ou por meio de um grupo,
   permanecem com o privilégio.
  </para>

  <para>
   Se for especificado <literal>GRANT OPTION FOR</literal> somente a opção de
   concessão do privilégio é revogada, e não o próprio privilégio. Se não for
   especificado, tanto o privilégio quanto a opção de concessão são revogados.
  </para>

  <para>
   Se o usuário possui um privilégio com opção de concessão, e concedeu este
   privilégio para outros usuários, então os privilégios que estes outros
   usuários possuem são chamados de privilégios dependentes.
   Se o privilégio ou a opção de concessão que o primeiro usuário possui for
   revogada, e existirem privilégios dependentes, estes privilégios dependentes
   também são revogados se for especificado <literal>CASCADE</literal>, senão
   a ação de revogar falha.
   Esta revogação recursiva somente afeta os privilégios que foram concedidos
   através de uma cadeia de usuários começando pelo usuário objeto deste comando
   <literal>REVOKE</literal>.
   Portanto, os usuários afetados poderão manter o privilégio se este privilégio
   também foi concedido por outros usuários.
  </para>
 </refsect1>

 <refsect1 id="SQL-REVOKE-notes">
  <title>Observações</title>

  <para>
   Use o comando <command>\z</command> do aplicativo <xref linkend="app-psql">
   para ver os privilégios concedidos para os objetos existentes.
   Consulte, também, o comando
   <xref linkend="sql-grant" endterm="sql-grant-title"> para obter informações
   sobre o formato.
  </para>

  <para>
   Um determinado usuário pode revogar somente os privilégios que foram
   concedidos diretamente por este usuário.
   Se, por exemplo, o usuário A conceder um privilégio com opção de concessão
   para o usuário B, e o usuário B por sua vez conceder o privilégio para o
   usuário C, então o usuário A não poderá revogar diretamente o privilégio de C.
   Em vez disso, o usuário A poderá revogar a opção de concessão do usuário B e
   usar a opção <literal>CASCADE</literal>, para que o privilégio seja por sua
   vez revogado do usuário C.
   Outro exemplo é o caso em que tanto A quanto B concedem o mesmo privilégio
   a C, neste caso A pode revogar sua própria concessão mas não a concessão de B
   e, portanto, C continua com a concessão mesmo que A a revogue.
  </para>

   <para>
    Quando alguém, que não é dono do objeto, tenta revogar privilégios para
    o objeto, o comando falha imediatamente se o usuário não possuir algum
    privilégio para o objeto.
    Desde que algum privilégio esteja disponível o comando prossegue, mas só
    revoga os privilégios para os quais o usuário tem a opção de concessão.
    A forma <command>REVOKE ALL PRIVILEGES</command> emite uma mensagem de advertência
    se nenhuma opção de concessão for possuída, enquanto as outras formas
    emitem mensagem de advertência se a opção de concessão para algum dos
    privilégios especificamente nomeados no comando não for possuída
    (Em princípio estas declarações também se aplicam ao dono do objeto,
    mas como o dono é sempre tratado como possuindo todas as opções de
    concessão estes casos nunca ocorrem).
   </para>

   <para>
    Se um superusuário decidir executar o comando <command>GRANT</command> ou
    o comando <command>REVOKE</command>, o comando é executado como se tivesse
    sido executado pelo dono do objeto afetado.
    Uma vez que todos os privilégios partem do dono do objeto (possivelmente de
    forma indireta através de cadeias de opções de concessão), um superusuário
    pode revogar todos os privilégios, mas pode ser necessário usar
    <literal>CASCADE</literal> conforme mostrado acima.
   </para>
 </refsect1>

 <refsect1 id="SQL-REVOKE-examples">
  <title>Exemplos</title>

  <para>
   Revogar o privilégio de inserção na tabela <literal>filmes</literal>
   concedido para todos os usuários:

<programlisting>
REVOKE INSERT ON filmes FROM PUBLIC;
</programlisting>
  </para>

  <para>
   Revogar todos os privilégios concedidos ao usuário <literal>manuel</literal>
   para a visão <literal>tipos</literal>:

<programlisting>
REVOKE ALL PRIVILEGES ON tipos FROM manuel;
</programlisting>

   Deve ser observado que este comando significa, na verdade,
   <quote>revogue todos os privilégios que eu concedi</quote>.
  </para>
 </refsect1>

 <refsect1 id="SQL-REVOKE-compatibility">
  <title>Compatibilidade</title>

   <para>
    As notas sobre compatibilidade presentes no comando
    <xref linkend="sql-grant" endterm="sql-grant-title">
    se aplicam de forma análoga ao comando <command>REVOKE</command>.
    O sumário da sintaxe é:

<synopsis>
REVOKE [ GRANT OPTION FOR ] <replaceable class="PARAMETER">privilégios</replaceable>
    ON <replaceable class="parameter">objeto</replaceable> [ ( <replaceable class="parameter">coluna</replaceable> [, ...] ) ]
    FROM { PUBLIC | <replaceable class="parameter">nome_do_usuário</replaceable> [, ...] }
    { RESTRICT | CASCADE }
</synopsis>
    Um entre <literal>RESTRICT</literal> ou <literal>CASCADE</literal>
    é necessário de acordo com o padrão, mas o
    <productname>PostgreSQL</productname> assume <literal>RESTRICT</literal>
    por padrão.
   </para>
 </refsect1>

 <refsect1>
  <title>Consulte também</title>

  <simpara>
   <xref linkend="sql-grant" endterm="sql-grant-title">
  </simpara>
 </refsect1>

</refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:nil
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
sgml-parent-document:nil
sgml-default-dtd-file:"../reference.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:"/usr/lib/sgml/catalog"
sgml-local-ecat-files:nil
End:
-->
